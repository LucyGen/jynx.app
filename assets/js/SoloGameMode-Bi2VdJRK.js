import{G as e}from"./sync-game-BdspoOK-.js";import{g as t}from"./logger-CHTAPRDI.js";import"./analytics-service-UCL_K60g.js";import"./firebase-vendor-sIns1Pds.js";import"./vendor-CEMwkx1U.js";class a{constructor(e,a){this.gameManager=e,this.inputManager=a,this.logger=t("SoloGameMode"),this.isActive=!1}async start(){this.logger.info("Starting solo game mode"),this.isActive=!0,this.setupUnifiedInput(),await this.gameManager.startSoloGame(),this.subscribeToGameEvents()}setupUnifiedInput(){this.jumpHandler=e=>{if(!this.isActive)return;const t=Date.now();this.gameManager.handleJumpInput({player:1,inputType:e.inputType||"TOUCH",timestamp:t}),this.gameManager.handleJumpInput({player:2,inputType:e.inputType||"TOUCH",timestamp:t}),this.logger.debug("Solo jump input - both dots triggered")},this.inputManager.on("jump",this.jumpHandler)}subscribeToGameEvents(){this.gameManager.on("perfectSync",(e=>{this.logger.info(`Perfect sync achieved! Combo: ${e.combo}`)})),this.gameManager.on("gameOver",(e=>{this.handleGameOver(e)}))}handleGameOver(e){this.logger.info("Solo game over",e),this.updateLocalHighScore(e.score);const t=this.calculatePerformanceRating(e);this.logger.debug("Performance rating:",t)}calculatePerformanceRating(e){const{score:t,perfectSyncs:a,maxCombo:s}=e;return t>=1e3&&a>=20&&s>=10?"S":t>=500&&a>=10&&s>=5?"A":t>=250&&a>=5?"B":t>=100?"C":"D"}updateLocalHighScore(e){e>parseInt(localStorage.getItem("sync_solo_high_score")||"0")&&(localStorage.setItem("sync_solo_high_score",e.toString()),this.logger.info(`New high score: ${e}`))}stop(){this.logger.info("Stopping solo game mode"),this.isActive=!1,this.jumpHandler&&(this.inputManager.off("jump",this.jumpHandler),this.jumpHandler=null),this.gameManager&&(this.gameManager.off("perfectSync",this.handlePerfectSync),this.gameManager.off("gameOver",this.handleGameOver))}getStats(){return{mode:e.SOLO,highScore:parseInt(localStorage.getItem("sync_solo_high_score")||"0"),gamesPlayed:parseInt(localStorage.getItem("sync_solo_games_played")||"0"),totalPerfectSyncs:parseInt(localStorage.getItem("sync_solo_total_syncs")||"0")}}}export{a as SoloGameMode,a as default};
