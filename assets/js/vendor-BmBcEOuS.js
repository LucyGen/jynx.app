import{_ as t}from"./firebase-vendor-yjSyvrsK.js";var e;function i(t,e,i){const n=typeof i,s=typeof t;if("undefined"!==n){if("undefined"!==s){if(i){if("function"===s&&n===s)return function(e){return t(i(e))};if((e=t.constructor)===i.constructor){if(e===Array)return i.concat(t);if(e===Map){var r=new Map(i);for(var h of t)r.set(h[0],h[1]);return r}if(e===Set){for(r of(h=new Set(i),t.values()))h.add(r);return h}}}return t}return i}return"undefined"===s?e:t}function n(t,e){return void 0===t?e:t}function s(){return Object.create(null)}function r(t){return"string"==typeof t}function h(t){return"object"==typeof t}function o(t,e){if(r(e))t=t[e];else for(let i=0;t&&i<e.length;i++)t=t[e[i]];return t}const l=/[^\p{L}\p{N}]+/u,c=/(\d{3})/g,f=/(\D)(\d{3})/g,u=/(\d{3})(\D)/g,a=/[\u0300-\u036f]/g;function g(t={}){if(!this||this.constructor!==g)return new g(...arguments);if(arguments.length)for(t=0;t<arguments.length;t++)this.assign(arguments[t]);else this.assign(t)}function d(t){t.F=null,t.B.clear(),t.D.clear()}function p(t,e,i){i||(e||"object"!=typeof t?"object"==typeof e&&(i=e,e=0):i=t),i&&(t=i.query||t,e=i.limit||e);let n=""+(e||0);i&&(n+=(i.offset||0)+!!i.context+!!i.suggest+(!1!==i.resolve)+(i.resolution||this.resolution)+(i.boost||0)),t=(""+t).toLowerCase(),this.cache||(this.cache=new m);let s=this.cache.get(t+n);if(!s){const r=i&&i.cache;r&&(i.cache=!1),s=this.search(t,e,i),r&&(i.cache=r),this.cache.set(t+n,s)}return s}function m(t){this.limit=t&&!0!==t?t:1e3,this.cache=new Map,this.h=""}(e=g.prototype).assign=function(t){this.normalize=i(t.normalize,!0,this.normalize);let e,n=t.include,s=n||t.exclude||t.split;if(s||""===s){if("object"==typeof s&&s.constructor!==RegExp){let t="";e=!n,n||(t+="\\p{Z}"),s.letter&&(t+="\\p{L}"),s.number&&(t+="\\p{N}",e=!!n),s.symbol&&(t+="\\p{S}"),s.punctuation&&(t+="\\p{P}"),s.control&&(t+="\\p{C}"),(s=s.char)&&(t+="object"==typeof s?s.join(""):s);try{this.split=new RegExp("["+(n?"^":"")+t+"]+","u")}catch(r){this.split=/\s+/}}else this.split=s,e=!1===s||"a1a".split(s).length<2;this.numeric=i(t.numeric,e)}else{try{this.split=i(this.split,l)}catch(h){this.split=/\s+/}this.numeric=i(t.numeric,i(this.numeric,!0))}if(this.prepare=i(t.prepare,null,this.prepare),this.finalize=i(t.finalize,null,this.finalize),s=t.filter,this.filter="function"==typeof s?s:i(s&&new Set(s),null,this.filter),this.dedupe=i(t.dedupe,!0,this.dedupe),this.matcher=i((s=t.matcher)&&new Map(s),null,this.matcher),this.mapper=i((s=t.mapper)&&new Map(s),null,this.mapper),this.stemmer=i((s=t.stemmer)&&new Map(s),null,this.stemmer),this.replacer=i(t.replacer,null,this.replacer),this.minlength=i(t.minlength,1,this.minlength),this.maxlength=i(t.maxlength,1024,this.maxlength),this.rtl=i(t.rtl,!1,this.rtl),(this.cache=s=i(t.cache,!0,this.cache))&&(this.F=null,this.L="number"==typeof s?s:2e5,this.B=new Map,this.D=new Map,this.I=this.H=128),this.h="",this.J=null,this.A="",this.K=null,this.matcher)for(const i of this.matcher.keys())this.h+=(this.h?"|":"")+i;if(this.stemmer)for(const i of this.stemmer.keys())this.A+=(this.A?"|":"")+i;return this},e.addStemmer=function(t,e){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(t,e),this.A+=(this.A?"|":"")+t,this.K=null,this.cache&&d(this),this},e.addFilter=function(t){return"function"==typeof t?this.filter=t:(this.filter||(this.filter=new Set),this.filter.add(t)),this.cache&&d(this),this},e.addMapper=function(t,e){return"object"==typeof t?this.addReplacer(t,e):t.length>1?this.addMatcher(t,e):(this.mapper||(this.mapper=new Map),this.mapper.set(t,e),this.cache&&d(this),this)},e.addMatcher=function(t,e){return"object"==typeof t?this.addReplacer(t,e):t.length<2&&(this.dedupe||this.mapper)?this.addMapper(t,e):(this.matcher||(this.matcher=new Map),this.matcher.set(t,e),this.h+=(this.h?"|":"")+t,this.J=null,this.cache&&d(this),this)},e.addReplacer=function(t,e){return"string"==typeof t?this.addMatcher(t,e):(this.replacer||(this.replacer=[]),this.replacer.push(t,e),this.cache&&d(this),this)},e.encode=function(t,e){if(this.cache&&t.length<=this.H)if(this.F){if(this.B.has(t))return this.B.get(t)}else this.F=setTimeout(d,50,this);this.normalize&&(t="function"==typeof this.normalize?this.normalize(t):a?t.normalize("NFKD").replace(a,"").toLowerCase():t.toLowerCase()),this.prepare&&(t=this.prepare(t)),this.numeric&&t.length>3&&(t=t.replace(f,"$1 $2").replace(u,"$1 $2").replace(c,"$1 "));const i=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer);let n,r,h=[],o=s(),l=this.split||""===this.split?t.split(this.split):[t];for(let s,c,f=0;f<l.length;f++)if((s=c=l[f])&&!(s.length<this.minlength||s.length>this.maxlength)){if(e){if(o[s])continue;o[s]=1}else{if(n===s)continue;n=s}if(i)h.push(s);else if(!this.filter||("function"==typeof this.filter?this.filter(s):!this.filter.has(s))){if(this.cache&&s.length<=this.I)if(this.F){var g=this.D.get(s);if(g||""===g){g&&h.push(g);continue}}else this.F=setTimeout(d,50,this);if(this.stemmer){let t;for(this.K||(this.K=new RegExp("(?!^)("+this.A+")$"));t!==s&&s.length>2;)t=s,s=s.replace(this.K,(t=>this.stemmer.get(t)))}if(s&&(this.mapper||this.dedupe&&s.length>1)){g="";for(let t,e,i=0,n="";i<s.length;i++)t=s.charAt(i),t===n&&this.dedupe||((e=this.mapper&&this.mapper.get(t))||""===e?e===n&&this.dedupe||!(n=e)||(g+=e):g+=n=t);s=g}if(this.matcher&&s.length>1&&(this.J||(this.J=new RegExp("("+this.h+")","g")),s=s.replace(this.J,(t=>this.matcher.get(t)))),s&&this.replacer)for(g=0;s&&g<this.replacer.length;g+=2)s=s.replace(this.replacer[g],this.replacer[g+1]);if(this.cache&&c.length<=this.I&&(this.D.set(c,s),this.D.size>this.L&&(this.D.clear(),this.I=this.I/1.1|0)),s){if(s!==c)if(e){if(o[s])continue;o[s]=1}else{if(r===s)continue;r=s}h.push(s)}}}return this.finalize&&(h=this.finalize(h)||h),this.cache&&t.length<=this.H&&(this.B.set(t,h),this.B.size>this.L&&(this.B.clear(),this.H=this.H/1.1|0)),h},m.prototype.set=function(t,e){this.cache.set(this.h=t,e),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)},m.prototype.get=function(t){const e=this.cache.get(t);return e&&this.h!==t&&(this.cache.delete(t),this.cache.set(this.h=t,e)),e},m.prototype.remove=function(t){for(const e of this.cache){const i=e[0];e[1].includes(t)&&this.cache.delete(i)}},m.prototype.clear=function(){this.cache.clear(),this.h=""};const w={normalize:!1,numeric:!1,dedupe:!1},y={},b=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),x=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),v=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],k={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,"ÃŸ":2,d:3,t:3,l:4,m:5,n:5,r:6};var j={Exact:w,Default:y,Normalize:y,LatinBalance:{mapper:b},LatinAdvanced:{mapper:b,matcher:x,replacer:v},LatinExtra:{mapper:b,replacer:v.concat([/(?!^)[aeo]/g,""]),matcher:x},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(t){for(let i=0;i<t.length;i++){var e=t[i];let n=e.charAt(0),s=k[n];for(let t,i=1;i<e.length&&(t=e.charAt(i),"h"===t||"w"===t||!(t=k[t])||t===s||(n+=t,s=t,4!==n.length));i++);t[i]=n}}},CJK:{split:""},LatinExact:w,LatinDefault:y,LatinSimple:y};function A(t,e,i,n){let s=[];for(let r,h=0;h<t.index.length;h++)if(r=t.index[h],e>=r.length)e-=r.length;else{const h=(e=r[n?"splice":"slice"](e,i)).length;if(h&&(s=s.length?s.concat(e):e,i-=h,n&&(t.length-=h),!i))break;e=0}return s}function B(t){if(!this||this.constructor!==B)return new B(t);this.index=t?[t]:[],this.length=t?t.length:0;const e=this;return new Proxy([],{get:(t,i)=>"length"===i?e.length:"push"===i?function(t){e.index[e.index.length-1].push(t),e.length++}:"pop"===i?function(){if(e.length)return e.length--,e.index[e.index.length-1].pop()}:"indexOf"===i?function(t){let i=0;for(let n,s,r=0;r<e.index.length;r++){if(n=e.index[r],s=n.indexOf(t),s>=0)return i+s;i+=n.length}return-1}:"includes"===i?function(t){for(let i=0;i<e.index.length;i++)if(e.index[i].includes(t))return!0;return!1}:"slice"===i?function(t,i){return A(e,t||0,i||e.length,!1)}:"splice"===i?function(t,i){return A(e,t||0,i||e.length,!0)}:"constructor"===i?Array:"symbol"!=typeof i?(t=e.index[i/2**31|0])&&t[i]:void 0,set:(t,i,n)=>(t=i/2**31|0,(e.index[t]||(e.index[t]=[]))[i]=n,e.length++,!0)})}function M(t=8){if(!this||this.constructor!==M)return new M(t);this.index=s(),this.h=[],this.size=0,t>32?(this.B=S,this.A=BigInt(t)):(this.B=D,this.A=t)}function z(t=8){if(!this||this.constructor!==z)return new z(t);this.index=s(),this.h=[],this.size=0,t>32?(this.B=S,this.A=BigInt(t)):(this.B=D,this.A=t)}function D(t){let e=2**this.A-1;if("number"==typeof t)return t&e;let i=0,n=this.A+1;for(let s=0;s<t.length;s++)i=(i*n^t.charCodeAt(s))&e;return 32===this.A?i+2**31:i}function S(t){let e=BigInt(2)**this.A-BigInt(1);var i=typeof t;if("bigint"===i)return t&e;if("number"===i)return BigInt(t)&e;i=BigInt(0);let n=this.A+BigInt(1);for(let s=0;s<t.length;s++)i=(i*n^BigInt(t.charCodeAt(s)))&e;return i}let C,_,I,O,L;async function E(t){var e=(t=t.data).task;const i=t.id;let n=t.args;if("init"===e)_=t.options||{},(e=t.factory)?(Function("return "+e)()(self),C=new self.FlexSearch.Index(_),delete self.FlexSearch):C=new Bt(_),postMessage({id:i});else{let s;"export"===e&&(n[1]?(n[0]=_.export,n[2]=0,n[3]=1):n=null),"import"===e?n[0]&&(t=await _.import.call(C,n[0]),C.import(n[0],t)):((s=n&&C[e].apply(C,n))&&s.then&&(s=await s),s&&s.await&&(s=await s.await),"search"===e&&s.result&&(s=s.result)),postMessage("search"===e?{id:i,msg:s}:{id:i})}}function P(t){N.call(t,"add"),N.call(t,"append"),N.call(t,"search"),N.call(t,"update"),N.call(t,"remove"),N.call(t,"searchCache")}function q(){I=L=0}function N(t){this[t+"Async"]=function(){const e=arguments;var i=e[e.length-1];let n;if("function"==typeof i&&(n=i,delete e[e.length-1]),I?L||(L=Date.now()-O>=this.priority*this.priority*3):(I=setTimeout(q,0),O=Date.now()),L){const i=this;return new Promise((n=>{setTimeout((function(){n(i[t+"Async"].apply(i,e))}),0)}))}const s=this[t].apply(this,e);return i=s.then?s:new Promise((t=>t(s))),n&&i.then(n),i}}B.prototype.clear=function(){this.index.length=0},B.prototype.push=function(){},M.prototype.get=function(t){const e=this.index[this.B(t)];return e&&e.get(t)},M.prototype.set=function(t,e){var i=this.B(t);let n=this.index[i];n?(i=n.size,n.set(t,e),(i-=n.size)&&this.size++):(this.index[i]=n=new Map([[t,e]]),this.h.push(n),this.size++)},z.prototype.add=function(t){var e=this.B(t);let i=this.index[e];i?(e=i.size,i.add(t),(e-=i.size)&&this.size++):(this.index[e]=i=new Set([t]),this.h.push(i),this.size++)},(e=M.prototype).has=z.prototype.has=function(t){const e=this.index[this.B(t)];return e&&e.has(t)},e.delete=z.prototype.delete=function(t){const e=this.index[this.B(t)];e&&e.delete(t)&&this.size--},e.clear=z.prototype.clear=function(){this.index=s(),this.h=[],this.size=0},e.values=z.prototype.values=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].values())yield e},e.keys=z.prototype.keys=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].keys())yield e},e.entries=z.prototype.entries=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].entries())yield e};let F=0;function T(e={},i){function n(t){function n(t){const e=(t=t.data||t).id,i=e&&o.h[e];i&&(i(t.msg),delete o.h[e])}if(this.worker=t,this.h=s(),this.worker)return h?this.worker.on("message",n):this.worker.onmessage=n,e.config?new Promise((function(t){F>1e9&&(F=0),o.h[++F]=function(){t(o)},o.worker.postMessage({id:F,task:"init",factory:r,options:e})})):(this.priority=e.priority||4,this.encoder=i||null,this.worker.postMessage({task:"init",factory:r,options:e}),this)}if(!this||this.constructor!==T)return new T(e);let r="undefined"!=typeof self?self._factory:"undefined"!=typeof window?window._factory:null;r&&(r=r.toString());const h="undefined"==typeof window,o=this,l=function(e,i,n){return i?"undefined"!=typeof module?new(require("worker_threads").Worker)(__dirname+"/worker/node.js"):t((()=>import("./__vite-browser-external-FmFgRqLi.js")),[]).then((function(t){return new t.Worker(import.meta.dirname+"/node/node.mjs")})):e?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+E.toString()],{type:"text/javascript"}))):new window.Worker("string"==typeof n?n:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js").replace("flexsearch.bundle.module.min.mjs","module/worker/worker.js"),{type:"module"})}(r,h,e.worker);return l.then?l.then((function(t){return n.call(o,t)})):n.call(this,l)}function $(t){T.prototype[t]=function(){const e=this,i=[].slice.call(arguments);var n=i[i.length-1];let s;return"function"==typeof n&&(s=n,i.pop()),n=new Promise((function(n){"export"===t&&"function"==typeof i[0]&&(i[0]=null),F>1e9&&(F=0),e.h[++F]=n,e.worker.postMessage({task:t,id:F,args:i})})),s?(n.then(s),this):n}}function R(t,e,i,n,r,h){if(t=t[r],n===i.length-1)e[r]=h||t;else if(t)if(t.constructor===Array)for(e=e[r]=Array(t.length),r=0;r<t.length;r++)R(t,e,i,n,r);else e=e[r]||(e[r]=s()),r=i[++n],R(t,e,i,n,r)}function J(t,e,i,n,s,r,h,o){if(t=t[h])if(n===e.length-1){if(t.constructor===Array){if(i[n]){for(e=0;e<t.length;e++)s.add(r,t[e],!0,!0);return}t=t.join(" ")}s.add(r,t,o,!0)}else if(t.constructor===Array)for(h=0;h<t.length;h++)J(t,e,i,n,s,r,h,o);else h=e[++n],J(t,e,i,n,s,r,h,o)}function K(t,e,i,n){if(!t.length)return t;if(1===t.length)return t=t[0],t=i||t.length>e?t.slice(i,i+e):t,n?rt.call(this,t):t;let s=[];for(let r,h,o=0;o<t.length;o++)if((r=t[o])&&(h=r.length)){if(i){if(i>=h){i-=h;continue}r=r.slice(i,i+e),h=r.length,i=0}if(h>e&&(r=r.slice(0,e),h=e),!s.length&&h>=e)return n?rt.call(this,r):r;if(s.push(r),!(e-=h))break}return s=s.length>1?[].concat.apply([],s):s[0],n?rt.call(this,s):s}function W(t,e,i,n){var s=n[0];if(s[0]&&s[0].query)return t[e].apply(t,s);if(!("and"!==e&&"not"!==e||t.result.length||t.await||s.suggest))return n.length>1&&(s=n[n.length-1]),(n=s.resolve)?t.await||t.result:t;let r,h,o,l,c,f=[],u=0,a=0;for(e=0;e<n.length;e++)if(s=n[e]){var g=void 0;if(s.constructor===X)g=s.await||s.result;else if(s.then||s.constructor===Array)g=s;else{u=s.limit||0,a=s.offset||0,o=s.suggest,h=s.resolve,r=((l=s.highlight||t.highlight)||s.enrich)&&h,g=s.queue;let i=s.async||g,n=s.index,d=s.query;if(n?t.index||(t.index=n):n=t.index,d||s.tag){const r=s.field||s.pluck;if(r&&(!d||t.query&&!l||(t.query=d,t.field=r,t.highlight=l),n=n.index.get(r)),g&&(c||t.await)){let r;c=1;const h=t.C.length,o=new Promise((function(t){r=t}));!function(e,n){o.h=function(){n.index=null,n.resolve=!1;let s=i?e.searchAsync(n):e.search(n);return s.then?s.then((function(e){return t.C[h]=e=e.result||e,r(e),e})):(s=s.result||s,r(s),s)}}(n,Object.assign({},s)),t.C.push(o),f[e]=o;continue}s.resolve=!1,s.index=null,g=i?n.searchAsync(s):n.search(s),s.resolve=h,s.index=n}else if(s.and)g=V(s,"and",n);else if(s.or)g=V(s,"or",n);else if(s.not)g=V(s,"not",n);else{if(!s.xor)continue;g=V(s,"xor",n)}}g.await?(c=1,g=g.await):g.then?(c=1,g=g.then((function(t){return t.result||t}))):g=g.result||g,f[e]=g}if(c&&!t.await&&(t.await=new Promise((function(e){t.return=e}))),c){const e=Promise.all(f).then((function(n){for(let s=0;s<t.C.length;s++)if(t.C[s]===e){t.C[s]=function(){return i.call(t,n,u,a,r,h,o,l)};break}Y(t)}));t.C.push(e)}else{if(!t.await)return i.call(t,f,u,a,r,h,o,l);t.C.push((function(){return i.call(t,f,u,a,r,h,o,l)}))}return h?t.await||t.result:t}function V(t,e,i){const n=(t=t[e])[0]||t;return n.index||(n.index=i),i=new X(n),t.length>1&&(i=i[e].apply(i,t.slice(1))),i}function G(t,e,i,n,s,r,h){return t.length&&(this.result.length&&t.push(this.result),t.length<2?this.result=t[0]:(this.result=et(t,e,i,!1,this.h),i=0)),s&&(this.await=null),s?this.resolve(e,i,n,h):this}function H(t,e,i,n,s,r,h){if(!r&&!this.result.length)return s?this.result:this;let o;if(t.length)if(this.result.length&&t.unshift(this.result),t.length<2)this.result=t[0];else{let n=0;for(let e,i,s=0;s<t.length;s++)if((e=t[s])&&(i=e.length))n<i&&(n=i);else if(!r){n=0;break}n?(this.result=tt(t,n,e,i,r,this.h,s),o=!0):this.result=[]}else r||(this.result=t);return s&&(this.await=null),s?this.resolve(e,i,n,h,o):this}function U(t,e,i,n,r,h,o){if(t.length)if(this.result.length&&t.unshift(this.result),t.length<2)this.result=t[0];else{t:{h=i;var l=this.h;const n=[],o=s();let c=0;for(let e,i=0;i<t.length;i++)if(e=t[i]){c<e.length&&(c=e.length);for(let t,i=0;i<e.length;i++)if(t=e[i])for(let e,n=0;n<t.length;n++)e=t[n],o[e]=o[e]?2:1}for(let i,s=0,f=0;s<c;s++)for(let c,u=0;u<t.length;u++)if((c=t[u])&&(i=c[s]))for(let a,g=0;g<i.length;g++)if(a=i[g],1===o[a])if(h)h--;else if(r){if(n.push(a),n.length===e){t=n;break t}}else{const i=s+(u?l:0);if(n[i]||(n[i]=[]),n[i].push(a),++f===e){t=n;break t}}t=n}this.result=t,l=!0}else h||(this.result=t);return r&&(this.await=null),r?this.resolve(e,i,n,o,l):this}function Z(t,e,i,n,s,r,h){if(!r&&!this.result.length)return s?this.result:this;if(t.length&&this.result.length){t:{r=i;var o=[];t=new Set(t.flat().flat());for(let i,n=0,h=0;n<this.result.length;n++)if(i=this.result[n])for(let l,c=0;c<i.length;c++)if(l=i[c],!t.has(l))if(r)r--;else if(s){if(o.push(l),o.length===e){t=o;break t}}else if(o[n]||(o[n]=[]),o[n].push(l),++h===e){t=o;break t}t=o}this.result=t,o=!0}return s&&(this.await=null),s?this.resolve(e,i,n,h,o):this}function Q(t,e,i,n,s){let r,h,l;"string"==typeof s?(r=s,s=""):r=s.template,h=r.indexOf("$1"),l=r.substring(h+2),h=r.substring(0,h);let c=s&&s.boundary,f=!s||!1!==s.clip,u=s&&s.merge&&l&&h&&new RegExp(l+" "+h,"g");var a=0;if("object"==typeof(s=s&&s.ellipsis)){var g=s.template;a=g.length-2,s=s.pattern}let d,p;"string"!=typeof s&&(s=!1===s?"":"..."),a&&(s=g.replace("$1",s)),g=s.length-a,"object"==typeof c&&(d=c.before,0===d&&(d=-1),p=c.after,0===p&&(p=-1),c=c.total||9e5),a=new Map;for(let L,E,P,q=0;q<e.length;q++){let N;if(n)N=e,P=n;else{var m=e[q];if(P=m.field,!P)continue;N=m.result}E=i.get(P),L=E.encoder,"string"!=typeof(m=a.get(L))&&(m=L.encode(t),a.set(L,m));for(let t=0;t<N.length;t++){var w=N[t].doc;if(!w)continue;if(!(w=o(w,P)))continue;var y=w.trim().split(/\s+/);if(!y.length)continue;w="";var b=[];let e=[];for(var x=-1,v=-1,k=0,j=0;j<y.length;j++){var A=y[j],B=L.encode(A);let t;if((B=B.length>1?B.join(" "):B[0])&&A){for(var M=A.length,z=(L.split?A.replace(L.split,""):A).length-B.length,D="",S=0,C=0;C<m.length;C++){var _=m[C];if(_){var I=_.length;I+=z<0?0:z,S&&I<=S||(_=B.indexOf(_))>-1&&(D=(_?A.substring(0,_):"")+h+A.substring(_,_+I)+l+(_+I<M?A.substring(_+I):""),S=I,t=!0)}}D&&(c&&(x<0&&(x=w.length+(w?1:0)),v=w.length+(w?1:0)+D.length,k+=M,e.push(b.length),b.push({match:D})),w+=(w?" ":"")+D)}if(t){if(c&&k>=c)break}else w+=(w?" ":"")+(A=y[j]),c&&b.push({text:A})}if(k=e.length*(r.length-2),d||p||c&&w.length-k>c)if(j=v-x,d>0&&(j+=d),p>0&&(j+=p),j<=(k=c+k-2*g))y=d?x-(d>0?d:0):x-((k-j)/2|0),b=p?v+(p>0?p:0):y+k,f||(y>0&&" "!==w.charAt(y)&&" "!==w.charAt(y-1)&&(y=w.indexOf(" ",y))<0&&(y=0),b<w.length&&" "!==w.charAt(b-1)&&" "!==w.charAt(b)&&((b=w.lastIndexOf(" ",b))<v?b=v:++b)),w=(y?s:"")+w.substring(y,b)+(b<w.length?s:"");else{for(v=[],x={},k={},j={},A={},B={},D=z=M=0,C=S=1;;){var O=void 0;for(let t,i=0;i<e.length;i++){if(t=e[i],D)if(z!==D){if(j[i+1])continue;if(t+=D,x[t]){M-=g,k[i+1]=1,j[i+1]=1;continue}if(t>=b.length-1){if(t>=b.length){j[i+1]=1,t>=y.length&&(k[i+1]=1);continue}M-=g}if(w=b[t].text,I=p&&B[i]){if(!(I>0)){j[i+1]=1;continue}if(w.length>I){if(j[i+1]=1,!f)continue;w=w.substring(0,I)}(I-=w.length)||(I=-1),B[i]=I}if(M+w.length+1<=c)w=" "+w,v[i]+=w;else{if(!f){j[i+1]=1;continue}(O=c-M-1)>0&&(w=" "+w.substring(0,O),v[i]+=w),j[i+1]=1}}else{if(j[i])continue;if(t-=z,x[t]){M-=g,j[i]=1,k[i]=1;continue}if(t<=0){if(t<0){j[i]=1,k[i]=1;continue}M-=g}if(w=b[t].text,I=d&&A[i]){if(!(I>0)){j[i]=1;continue}if(w.length>I){if(j[i]=1,!f)continue;w=w.substring(w.length-I)}(I-=w.length)||(I=-1),A[i]=I}if(M+w.length+1<=c)w+=" ",v[i]=w+v[i];else{if(!f){j[i]=1;continue}(O=w.length+1-(c-M))>=0&&O<w.length&&(w=w.substring(O)+" ",v[i]=w+v[i]),j[i]=1}}else{let e;if(w=b[t].match,d&&(A[i]=d),p&&(B[i]=p),i&&M++,t?!i&&g&&(M+=g):(k[i]=1,j[i]=1),t>=y.length-1||t<b.length-1&&b[t+1].match?e=1:g&&(M+=g),M-=r.length-2,i&&!(M+w.length<=c)){O=S=C=k[i]=0;break}v[i]=w,e&&(k[i+1]=1,j[i+1]=1)}M+=w.length,O=x[t]=1}if(O)z===D?D++:z++;else{if(z===D?S=0:C=0,!S&&!C)break;S?D=++z:D++}}w="";for(let t,e=0;e<v.length;e++)t=(k[e]?e?" ":"":(e&&!s?" ":"")+s)+v[e],w+=t;s&&!k[v.length]&&(w+=s)}u&&(w=w.replace(u," ")),N[t].highlight=w}if(n)break}return e}function X(t,e){if(!this||this.constructor!==X)return new X(t,e);let i,n,s,r,h,o,l=0;if(t&&t.index){const i=t;if(e=i.index,l=i.boost||0,n=i.query){s=i.field||i.pluck,r=i.highlight;const n=i.resolve;t=i.async||i.queue,i.resolve=!1,i.index=null,t=t?e.searchAsync(i):e.search(i),i.resolve=n,i.index=e,t=t.result||t}else t=[]}if(t&&t.then){const e=this;i=[t=t.then((function(t){e.C[0]=e.result=t.result||t,Y(e)}))],t=[],h=new Promise((function(t){o=t}))}this.index=e||null,this.result=t||[],this.h=l,this.C=i||[],this.await=h||null,this.return=o||null,this.highlight=r||null,this.query=n||"",this.field=s||""}function Y(t,e){let i=t.result;var n=t.await;t.await=null;for(let s,r=0;r<t.C.length;r++)if(s=t.C[r])if("function"==typeof s)i=s(),t.C[r]=i=i.result||i,r--;else if(s.h)i=s.h(),t.C[r]=i=i.result||i,r--;else if(s.then)return t.await=n;return n=t.return,t.C=[],t.return=null,e||n(i),i}function tt(t,e,i,n,r,h,o){const l=t.length;let c,f,u=[];c=s();for(let s,a,g,d,p=0;p<e;p++)for(let e=0;e<l;e++)if(g=t[e],p<g.length&&(s=g[p]))for(let t=0;t<s.length;t++){if(a=s[t],(f=c[a])?c[a]++:(f=0,c[a]=1),d=u[f]||(u[f]=[]),!o){let t=p+(e||!r?0:h||0);d=d[t]||(d[t]=[])}if(d.push(a),o&&i&&f===l-1&&d.length-n===i)return n?d.slice(n):d}if(t=u.length)if(r)u=u.length>1?et(u,i,n,o,h):(u=u[0])&&i&&u.length>i||n?u.slice(n,i+n):u;else{if(t<l)return[];if(u=u[t-1],i||n)if(o)(u.length>i||n)&&(u=u.slice(n,i+n));else{r=[];for(let t,e=0;e<u.length;e++)if(t=u[e])if(n&&t.length>n)n-=t.length;else if((i&&t.length>i||n)&&(t=t.slice(n,i+n),i-=t.length,n&&(n-=t.length)),r.push(t),!i)break;u=r}}return u}function et(t,e,i,n,r){const h=[],o=s();let l;var c=t.length;let f;if(n){for(r=c-1;r>=0;r--)if(f=(n=t[r])&&n.length)for(c=0;c<f;c++)if(l=n[c],!o[l])if(o[l]=1,i)i--;else if(h.push(l),h.length===e)return h}else for(let s,u=c-1,a=0;u>=0;u--){s=t[u];for(let t=0;t<s.length;t++)if(f=(n=s[t])&&n.length)for(let s=0;s<f;s++)if(l=n[s],!o[l])if(o[l]=1,i)i--;else{let i=(t+(u<c-1&&r||0))/(u+1)|0;if((h[i]||(h[i]=[])).push(l),++a===e)return h}}return h}function it(t,e,i,n,r){const h=s(),o=[];for(let s,l=0;l<e.length;l++){s=e[l];for(let t=0;t<s.length;t++)h[s[t]]=1}if(r){for(let s,l=0;l<t.length;l++)if(s=t[l],h[s])if(n)n--;else if(o.push(s),h[s]=0,i&&0==--i)break}else for(let s,l,c=0;c<t.result.length;c++)for(s=t.result[c],e=0;e<s.length;e++)l=s[e],h[l]&&((o[c]||(o[c]=[])).push(l),h[l]=0);return o}function nt(t){const e=[],i=s(),n=s();for(let s,r,h,o,l,c,f,u=0;u<t.length;u++){s=t[u],r=s.field,h=s.result;for(let t=0;t<h.length;t++)l=h[t],"object"!=typeof l?l={id:o=l}:o=l.id,(c=i[o])?c.push(r):(l.field=i[o]=[r],e.push(l)),(f=l.highlight)&&(c=n[o],c||(n[o]=c={},l.highlight=c),c[r]=f)}return e}function st(t,e,i,n,s){return(t=this.tag.get(t))&&(t=t.get(e))?((e=t.length-n)>0&&((i&&e>i||n)&&(t=t.slice(n,n+i)),s&&(t=rt.call(this,t))),t):[]}function rt(t){if(!this||!this.store)return t;if(this.db)return this.index.get(this.field[0]).db.enrich(t);const e=Array(t.length);for(let i,n=0;n<t.length;n++)i=t[n],e[n]={id:i,doc:this.store.get(i)};return e}function ht(t){if(!this||this.constructor!==ht)return new ht(t);const e=t.document||t.doc||t;let i,n;if(this.B=[],this.field=[],this.D=[],this.key=(i=e.key||e.id)&&lt(i,this.D)||"id",(n=t.keystore||0)&&(this.keystore=n),this.fastupdate=!!t.fastupdate,this.reg=!this.fastupdate||t.worker||t.db?n?new z(n):new Set:n?new M(n):new Map,this.h=(i=e.store||null)&&i&&!0!==i&&[],this.store=i?n?new M(n):new Map:null,this.cache=(i=t.cache||null)&&new m(i),t.cache=!1,this.worker=t.worker||!1,this.priority=t.priority||4,this.index=ot.call(this,t,e),this.tag=null,(i=e.tag)&&("string"==typeof i&&(i=[i]),i.length)){this.tag=new Map,this.A=[],this.F=[];for(let t,e,n=0;n<i.length;n++){if(t=i[n],e=t.field||t,!e)throw Error("The tag field from the document descriptor is undefined.");t.custom?this.A[n]=t.custom:(this.A[n]=lt(e,this.D),t.filter&&("string"==typeof this.A[n]&&(this.A[n]=new String(this.A[n])),this.A[n].G=t.filter)),this.F[n]=e,this.tag.set(e,new Map)}}if(this.worker){this.fastupdate=!1,t=[];for(const e of this.index.values())e.then&&t.push(e);if(t.length){const e=this;return Promise.all(t).then((function(t){let i=0;for(const n of e.index.entries()){const s=n[0];let r=n[1];r.then&&(r=t[i],e.index.set(s,r),i++)}return e}))}}else t.db&&(this.fastupdate=!1,this.mount(t.db))}function ot(t,e){const i=new Map;let n=e.index||e.field||e;r(n)&&(n=[n]);for(let o,l,c=0;c<n.length;c++){if(o=n[c],r(o)||(l=o,o=o.field),l=h(l)?Object.assign({},t,l):t,this.worker){var s=void 0;s=new T(l,s=(s=l.encoder)&&s.encode?s:new g("string"==typeof s?j[s]:s||{})),i.set(o,s)}this.worker||i.set(o,new Bt(l,this.reg)),l.custom?this.B[c]=l.custom:(this.B[c]=lt(o,this.D),l.filter&&("string"==typeof this.B[c]&&(this.B[c]=new String(this.B[c])),this.B[c].G=l.filter)),this.field[c]=o}if(this.h){r(t=e.store)&&(t=[t]);for(let e,i,n=0;n<t.length;n++)e=t[n],i=e.field||e,e.custom?(this.h[n]=e.custom,e.custom.O=i):(this.h[n]=lt(i,this.D),e.filter&&("string"==typeof this.h[n]&&(this.h[n]=new String(this.h[n])),this.h[n].G=e.filter))}return i}function lt(t,e){const i=t.split(":");let n=0;for(let s=0;s<i.length;s++)"]"===(t=i[s])[t.length-1]&&(t=t.substring(0,t.length-2))&&(e[n]=!0),t&&(i[n++]=t);return n<i.length&&(i.length=n),n>1?i:i[0]}function ct(t,e=0){let i=[],n=[];e&&(e=25e4/e*5e3|0);for(const s of t.entries())n.push(s),n.length===e&&(i.push(n),n=[]);return n.length&&i.push(n),i}function ft(t,e){e||(e=new Map);for(let i,n=0;n<t.length;n++)i=t[n],e.set(i[0],i[1]);return e}function ut(t,e=0){let i=[],n=[];e&&(e=25e4/e*1e3|0);for(const s of t.entries())n.push([s[0],ct(s[1])[0]||[]]),n.length===e&&(i.push(n),n=[]);return n.length&&i.push(n),i}function at(t,e){e||(e=new Map);for(let i,n,s=0;s<t.length;s++)i=t[s],n=e.get(i[0]),e.set(i[0],ft(i[1],n));return e}function gt(t){let e=[],i=[];for(const n of t.keys())i.push(n),25e4===i.length&&(e.push(i),i=[]);return i.length&&e.push(i),e}function dt(t,e){e||(e=new Set);for(let i=0;i<t.length;i++)e.add(t[i]);return e}function pt(t,e,i,n,s,r,h=0){const o=n&&n.constructor===Array;var l=o?n.shift():n;if(!l)return this.export(t,e,s,r+1);if((l=t((e?e+".":"")+(h+1)+"."+i,JSON.stringify(l)))&&l.then){const c=this;return l.then((function(){return pt.call(c,t,e,i,o?n:null,s,r,h+1)}))}return pt.call(this,t,e,i,o?n:null,s,r,h+1)}function mt(t,e){let i="";for(const n of t.entries()){t=n[0];const s=n[1];let r="";for(let t,i=0;i<s.length;i++){t=s[i]||[""];let n="";for(let i=0;i<t.length;i++)n+=(n?",":"")+("string"===e?'"'+t[i]+'"':t[i]);n="["+n+"]",r+=(r?",":"")+n}r='["'+t+'",['+r+"]]",i+=(i?",":"")+r}return i}function wt(t,e){let i=0;var n=void 0===e;if(t.constructor===Array){for(let s,r,h,o=0;o<t.length;o++)if((s=t[o])&&s.length){if(n)return 1;if(r=s.indexOf(e),r>=0){if(s.length>1)return s.splice(r,1),1;if(delete t[o],i)return 1;h=1}else{if(h)return 1;i++}}}else for(let s of t.entries())n=s[0],wt(s[1],e)?i++:t.delete(n);return i}$("add"),$("append"),$("search"),$("update"),$("remove"),$("clear"),$("export"),$("import"),T.prototype.searchCache=p,P(T.prototype),ht.prototype.add=function(t,e,i){if(h(t)&&(t=o(e=t,this.key)),e&&(t||0===t)){if(!i&&this.reg.has(t))return this.update(t,e);for(let s,h=0;h<this.field.length;h++){s=this.B[h];var n=this.index.get(this.field[h]);if("function"==typeof s){var l=s(e);l&&n.add(t,l,i,!0)}else(!(l=s.G)||l(e))&&(s.constructor===String?s=[""+s]:r(s)&&(s=[s]),J(e,s,this.D,0,n,t,s[0],i))}if(this.tag)for(n=0;n<this.A.length;n++){var c=this.A[n];l=this.tag.get(this.F[n]);let h=s();if("function"==typeof c){if(!(c=c(e)))continue}else{var f=c.G;if(f&&!f(e))continue;c.constructor===String&&(c=""+c),c=o(e,c)}if(l&&c){r(c)&&(c=[c]);for(let e,n,s=0;s<c.length;s++)if(e=c[s],!h[e]&&(h[e]=1,(f=l.get(e))?n=f:l.set(e,n=[]),!i||!n.includes(t))){if(n.length===2**31-1){if(f=new B(n),this.fastupdate)for(let t of this.reg.values())t.includes(n)&&(t[t.indexOf(n)]=f);l.set(e,n=f)}n.push(t),this.fastupdate&&((f=this.reg.get(t))?f.push(n):this.reg.set(t,[n]))}}}if(this.store&&(!i||!this.store.has(t))){let n;if(this.h){n=s();for(let t,s=0;s<this.h.length;s++){if(t=this.h[s],(i=t.G)&&!i(e))continue;let h;if("function"==typeof t){if(h=t(e),!h)continue;t=[t.O]}else if(r(t)||t.constructor===String){n[t]=e[t];continue}R(e,n,t,0,t[0],h)}}this.store.set(t,n||e)}this.worker&&(this.fastupdate||this.reg.add(t))}return this},X.prototype.or=function(){return W(this,"or",G,arguments)},X.prototype.and=function(){return W(this,"and",H,arguments)},X.prototype.xor=function(){return W(this,"xor",U,arguments)},X.prototype.not=function(){return W(this,"not",Z,arguments)},(e=X.prototype).limit=function(t){if(this.await){const e=this;this.C.push((function(){return e.limit(t).result}))}else if(this.result.length){const e=[];for(let i,n=0;n<this.result.length;n++)if(i=this.result[n]){if(!(i.length<=t)){e[n]=i.slice(0,t);break}if(e[n]=i,!(t-=i.length))break}this.result=e}return this},e.offset=function(t){if(this.await){const e=this;this.C.push((function(){return e.offset(t).result}))}else if(this.result.length){const e=[];for(let i,n=0;n<this.result.length;n++)(i=this.result[n])&&(i.length<=t?t-=i.length:(e[n]=i.slice(t),t=0));this.result=e}return this},e.boost=function(t){if(this.await){const e=this;this.C.push((function(){return e.boost(t).result}))}else this.h+=t;return this},e.resolve=function(t,e,i,n,s){let r=this.await?Y(this,!0):this.result;if(r.then){const h=this;return r.then((function(){return h.resolve(t,e,i,n,s)}))}return r.length&&("object"==typeof t?(n=t.highlight||this.highlight,i=!!n||t.enrich,e=t.offset,t=t.limit):(n=n||this.highlight,i=!!n||i),r=s?i?rt.call(this.index,r):r:K.call(this.index,r,t||100,e,i)),this.finalize(r,n)},e.finalize=function(t,e){if(t.then){const i=this;return t.then((function(t){return i.finalize(t,e)}))}e&&t.length&&this.query&&(t=Q(this.query,t,this.index.index,this.field,e));const i=this.return;return this.highlight=this.index=this.result=this.C=this.await=this.return=null,this.query=this.field="",i&&i(t),t},ht.prototype.search=function(t,e,i,s){i||(!e&&h(t)?(i=t,t=""):h(e)&&(i=e,e=0));let o=[];var l=[];let c,f,u,a,g,d,p,m,w=0,y=!0;if(i){i.constructor===Array&&(i={index:i}),t=i.query||t,c=i.pluck,f=i.merge,a=i.boost,d=c||i.field||(d=i.index)&&(d.index?null:d);var b=this.tag&&i.tag;u=i.suggest,y=!1!==i.resolve,g=i.cache,p=y&&this.store&&i.highlight;var x=!!p||y&&this.store&&i.enrich;e=i.limit||e;var v=i.offset||0;if(e||(e=y?100:0),b&&(!this.db||!s)){b.constructor!==Array&&(b=[b]);var k=[];for(let t,e=0;e<b.length;e++)if(t=b[e],t.field&&t.tag){var j=t.tag;if(j.constructor===Array)for(var A=0;A<j.length;A++)k.push(t.field,j[A]);else k.push(t.field,j)}else{j=Object.keys(t);for(let e,i,n=0;n<j.length;n++)if(e=j[n],i=t[e],i.constructor===Array)for(A=0;A<i.length;A++)k.push(e,i[A]);else k.push(e,i)}if(b=k,!t){if(l=[],k.length)for(b=0;b<k.length;b+=2){if(this.db){if(!(s=this.index.get(k[b])))continue;l.push(s=s.db.tag(k[b+1],e,v,x))}else s=st.call(this,k[b],k[b+1],e,v,x);o.push(y?{field:k[b],tag:k[b+1],result:s}:[s])}if(l.length){const t=this;return Promise.all(l).then((function(e){for(let t=0;t<e.length;t++)y?o[t].result=e[t]:o[t]=e[t];return y?o:new X(o.length>1?tt(o,1,0,0,u,a):o[0],t)}))}return y?o:new X(o.length>1?tt(o,1,0,0,u,a):o[0],this)}}y||c||!(d=d||this.field)||(r(d)?c=d:(d.constructor===Array&&1===d.length&&(d=d[0]),c=d.field||d.index)),d&&d.constructor!==Array&&(d=[d])}d||(d=this.field),k=(this.worker||this.db)&&!s&&[];for(let h,M,z,D=0;D<d.length;D++){if(M=d[D],this.db&&this.tag&&!this.B[D])continue;let c;if(r(M)||(c=M,M=c.field,t=c.query||t,e=n(c.limit,e),v=n(c.offset,v),u=n(c.suggest,u),p=y&&this.store&&n(c.highlight,p),x=!!p||y&&this.store&&n(c.enrich,x),g=n(c.cache,g)),s)h=s[D];else{A=(j=c||i||{}).enrich;var B=this.index.get(M);if(b&&(this.db&&(j.tag=b,j.field=d,m=B.db.support_tag_search),!m&&A&&(j.enrich=!1),m||(j.limit=0,j.offset=0)),h=g?B.searchCache(t,b&&!m?0:e,j):B.search(t,b&&!m?0:e,j),b&&!m&&(j.limit=e,j.offset=v),A&&(j.enrich=A),k){k[D]=h;continue}}if(z=(h=h.result||h)&&h.length,b&&z){if(j=[],A=0,this.db&&s){if(!m)for(B=d.length;B<s.length;B++){let t=s[B];if(t&&t.length)A++,j.push(t);else if(!u)return y?o:new X(o,this)}}else for(let t,e,i=0;i<b.length;i+=2){if(t=this.tag.get(b[i]),!t){if(u)continue;return y?o:new X(o,this)}if(e=(t=t&&t.get(b[i+1]))&&t.length)A++,j.push(t);else if(!u)return y?o:new X(o,this)}if(A){if(h=it(h,j,e,v,y),z=h.length,!z&&!u)return y?h:new X(h,this);A--}}if(z)l[w]=M,o.push(h),w++;else if(1===d.length)return y?o:new X(o,this)}if(k){if(this.db&&b&&b.length&&!m)for(x=0;x<b.length;x+=2){if(!(l=this.index.get(b[x]))){if(u)continue;return y?o:new X(o,this)}k.push(l.db.tag(b[x+1],e,v,!1))}const n=this;return Promise.all(k).then((function(s){return i&&(i.resolve=y),s.length&&(s=n.search(t,e,i,s)),s}))}if(!w)return y?o:new X(o,this);if(c&&(!x||!this.store))return o=o[0],y?o:new X(o,this);for(k=[],v=0;v<l.length;v++){if(b=o[v],x&&b.length&&void 0===b[0].doc&&(this.db?k.push(b=this.index.get(this.field[0]).db.enrich(b)):b=rt.call(this,b)),c)return y?p?Q(t,b,this.index,c,p):b:new X(b,this);o[v]={field:l[v],result:b}}if(x&&this.db&&k.length){const e=this;return Promise.all(k).then((function(i){for(let t=0;t<i.length;t++)o[t].result=i[t];return p&&(o=Q(t,o,e.index,c,p)),f?nt(o):o}))}return p&&(o=Q(t,o,this.index,c,p)),f?nt(o):o},(e=ht.prototype).mount=function(t){let e=this.field;if(this.tag)for(let r,h=0;h<this.F.length;h++){r=this.F[h];var i=void 0;this.index.set(r,i=new Bt({},this.reg)),e===this.field&&(e=e.slice(0)),e.push(r),i.tag=this.tag.get(r)}i=[];const n={db:t.db,type:t.type,fastupdate:t.fastupdate};for(let r,h,o=0;o<e.length;o++){n.field=h=e[o],r=this.index.get(h);const s=new t.constructor(t.id,n);s.id=t.id,i[o]=s.mount(r),r.document=!0,o?r.bypass=!0:r.store=this.store}const s=this;return this.db=Promise.all(i).then((function(){s.db=!0}))},e.commit=async function(){const t=[];for(const e of this.index.values())t.push(e.commit());await Promise.all(t),this.reg.clear()},e.destroy=function(){const t=[];for(const e of this.index.values())t.push(e.destroy());return Promise.all(t)},e.append=function(t,e){return this.add(t,e,!0)},e.update=function(t,e){return this.remove(t).add(t,e)},e.remove=function(t){for(var e of(h(t)&&(t=o(t,this.key)),this.index.values()))e.remove(t,!0);if(this.reg.has(t)){if(this.tag&&!this.fastupdate)for(let i of this.tag.values())for(let n of i){e=n[0];const s=n[1],r=s.indexOf(t);r>-1&&(s.length>1?s.splice(r,1):i.delete(e))}this.store&&this.store.delete(t),this.reg.delete(t)}return this.cache&&this.cache.remove(t),this},e.clear=function(){const t=[];for(const e of this.index.values()){const i=e.clear();i.then&&t.push(i)}if(this.tag)for(const e of this.tag.values())e.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),t.length?Promise.all(t):this},e.contain=function(t){return this.db?this.index.get(this.field[0]).db.has(t):this.reg.has(t)},e.cleanup=function(){for(const t of this.index.values())t.cleanup();return this},e.get=function(t){return this.db?this.index.get(this.field[0]).db.enrich(t).then((function(t){return t[0]&&t[0].doc||null})):this.store.get(t)||null},e.set=function(t,e){return"object"==typeof t&&(t=o(e=t,this.key)),this.store.set(t,e),this},e.searchCache=p,e.export=function(t,e,i=0,n=0){if(i<this.field.length){const s=this.field[i];if((e=this.index.get(s).export(t,s,i,n=1))&&e.then){const n=this;return e.then((function(){return n.export(t,s,i+1)}))}return this.export(t,s,i+1)}let s,r;switch(n){case 0:s="reg",r=gt(this.reg),e=null;break;case 1:s="tag",r=this.tag&&ut(this.tag,this.reg.size),e=null;break;case 2:s="doc",r=this.store&&ct(this.store),e=null;break;default:return}return pt.call(this,t,e,s,r||null,i,n)},e.import=function(t,e){var i=t.split(".");"json"===i[i.length-1]&&i.pop();const n=i.length>2?i[0]:"";if(i=i.length>2?i[2]:i[1],this.worker&&n)return this.index.get(n).import(t);if(e){if("string"==typeof e&&(e=JSON.parse(e)),n)return this.index.get(n).import(i,e);switch(i){case"reg":this.fastupdate=!1,this.reg=dt(e,this.reg);for(let t,e=0;e<this.field.length;e++)t=this.index.get(this.field[e]),t.fastupdate=!1,t.reg=this.reg;if(this.worker){e=[];for(const i of this.index.values())e.push(i.import(t));return Promise.all(e)}break;case"tag":this.tag=at(e,this.tag);break;case"doc":this.store=ft(e,this.store)}}},P(ht.prototype),Bt.prototype.remove=function(t,e){const i=this.reg.size&&(this.fastupdate?this.reg.get(t):this.reg.has(t));if(i){if(this.fastupdate){for(let e,n,s=0;s<i.length;s++)if((e=i[s])&&(n=e.length))if(e[n-1]===t)e.pop();else{const i=e.indexOf(t);i>=0&&e.splice(i,1)}}else wt(this.map,t),this.depth&&wt(this.ctx,t);e||this.reg.delete(t)}return this.db&&(this.commit_task.push({del:t}),this.M&&Mt(this)),this.cache&&this.cache.remove(t),this};const yt={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};function bt(t,e,i,n,r,h,o){let l,c;if(!(l=e[i])||o&&!l[o]){if(o?((e=l||(e[i]=s()))[o]=1,c=t.ctx,(l=c.get(o))?c=l:c.set(o,c=t.keystore?new M(t.keystore):new Map)):(c=t.map,e[i]=1),(l=c.get(i))?c=l:c.set(i,c=l=[]),h)for(let i,s=0;s<l.length;s++)if((i=l[s])&&i.includes(r)){if(s<=n)return;i.splice(i.indexOf(r),1),t.fastupdate&&(e=t.reg.get(r))&&e.splice(e.indexOf(i),1);break}if(c=c[n]||(c[n]=[]),c.push(r),c.length===2**31-1){if(e=new B(c),t.fastupdate)for(let i of t.reg.values())i.includes(c)&&(i[i.indexOf(c)]=e);l[n]=c=e}t.fastupdate&&((n=t.reg.get(r))?n.push(c):t.reg.set(r,[c]))}}function xt(t,e,i,n,s){return i&&t>1?e+(n||0)<=t?i+(s||0):(t-1)/(e+(n||0))*(i+(s||0))+1|0:0}function vt(t,e,i,n,s,r,h){let o=t.length,l=t;if(o>1)l=tt(t,e,i,n,s,r,h);else if(1===o)return h?K.call(null,t[0],i,n):new X(t[0],this);return h?l:new X(l,this)}function kt(t,e,i,n,s,r,h){return t=At(this,t,e,i,n,s,r,h),this.db?t.then((function(t){return s?t||[]:new X(t,this)})):t&&t.length?s?K.call(this,t,i,n):new X(t,this):s?[]:new X([],this)}function jt(t,e,i,n){let s=[];if(t&&t.length){if(t.length<=n)return void e.push(t);for(let e,i=0;i<n;i++)(e=t[i])&&(s[i]=e);if(s.length)return void e.push(s)}if(!i)return s}function At(t,e,i,n,s,r,h,o){let l;return i&&(l=t.bidirectional&&e>i)&&(l=i,i=e,e=l),t.db?t.db.get(e,i,n,s,r,h,o):t=i?(t=t.ctx.get(i))&&t.get(e):t.map.get(e)}function Bt(t,e){if(!this||this.constructor!==Bt)return new Bt(t);if(t){var i=r(t)?t:t.preset;i&&(t=Object.assign({},yt[i],t))}else t={};const n=!0===(i=t.context)?{depth:1}:i||{},s=r(t.encoder)?j[t.encoder]:t.encode||t.encoder||{};this.encoder=s.encode?s:"object"==typeof s?new g(s):{encode:s},this.resolution=t.resolution||9,this.tokenize=i=(i=t.tokenize)&&"default"!==i&&"exact"!==i&&i||"strict",this.depth="strict"===i&&n.depth||0,this.bidirectional=!1!==n.bidirectional,this.fastupdate=!!t.fastupdate,this.score=t.score||null,(i=t.keystore||0)&&(this.keystore=i),this.map=i?new M(i):new Map,this.ctx=i?new M(i):new Map,this.reg=e||(this.fastupdate?i?new M(i):new Map:i?new z(i):new Set),this.N=n.resolution||3,this.rtl=s.rtl||t.rtl||!1,this.cache=(i=t.cache||null)&&new m(i),this.resolve=!1!==t.resolve,(i=t.db)&&(this.db=this.mount(i)),this.M=!1!==t.commit,this.commit_task=[],this.commit_timer=null,this.priority=t.priority||4}function Mt(t){t.commit_timer||(t.commit_timer=setTimeout((function(){t.commit_timer=null,t.db.commit(t)}),1))}Bt.prototype.add=function(t,e,i,n){if(e&&(t||0===t)){if(!n&&!i&&this.reg.has(t))return this.update(t,e);n=this.depth;const f=(e=this.encoder.encode(e,!n)).length;if(f){const u=s(),a=s(),g=this.resolution;for(let s=0;s<f;s++){let d=e[this.rtl?f-1-s:s];var r=d.length;if(r&&(n||!a[d])){var h=this.score?this.score(e,d,s,null,0):xt(g,f,s),o="";switch(this.tokenize){case"tolerant":if(bt(this,a,d,h,t,i),r>2){for(let e,n,s,l,c=1;c<r-1;c++)e=d.charAt(c),n=d.charAt(c+1),s=d.substring(0,c)+n,l=d.substring(c+2),bt(this,a,o=s+e+l,h,t,i),bt(this,a,o=s+l,h,t,i);bt(this,a,d.substring(0,d.length-1),h,t,i)}break;case"full":if(r>2){for(let n,c=0;c<r;c++)for(h=r;h>c;h--){o=d.substring(c,h),n=this.rtl?r-1-c:c;var l=this.score?this.score(e,d,s,o,n):xt(g,f,s,r,n);bt(this,a,o,l,t,i)}break}case"bidirectional":case"reverse":if(r>1){for(l=r-1;l>0;l--){o=d[this.rtl?r-1-l:l]+o;var c=this.score?this.score(e,d,s,o,l):xt(g,f,s,r,l);bt(this,a,o,c,t,i)}o=""}case"forward":if(r>1){for(l=0;l<r;l++)bt(this,a,o+=d[this.rtl?r-1-l:l],h,t,i);break}default:if(bt(this,a,d,h,t,i),n&&f>1&&s<f-1)for(r=this.N,o=d,h=Math.min(n+1,this.rtl?s+1:f-s),l=1;l<h;l++)d=e[this.rtl?f-1-s-l:s+l],bt(this,u,(c=this.bidirectional&&d>o)?o:d,this.score?this.score(e,o,s,d,l-1):xt(r+(f/2>r?0:1),f,s,h-1,l-1),t,i,c?d:o)}}}this.fastupdate||this.reg.add(t)}}return this.db&&(this.commit_task.push(i?{ins:t}:{del:t}),this.M&&Mt(this)),this},Bt.prototype.search=function(t,e,i){if(i||(e||"object"!=typeof t?"object"==typeof e&&(i=e,e=0):(i=t,t="")),i&&i.cache)return i.cache=!1,t=this.searchCache(t,e,i),i.cache=!0,t;let n,r,h,o,l,c,f,u,a=[],g=0;i&&(t=i.query||t,e=i.limit||e,g=i.offset||0,r=i.context,h=i.suggest,u=(o=i.resolve)&&i.enrich,c=i.boost,f=i.resolution,l=this.db&&i.tag),void 0===o&&(o=this.resolve),r=this.depth&&!1!==r;let d=this.encoder.encode(t,!r);if(n=d.length,e=e||(o?100:0),1===n)return kt.call(this,d[0],"",e,g,o,u,l);if(2===n&&r&&!h)return kt.call(this,d[1],d[0],e,g,o,u,l);let p,m=s(),w=0;if(r&&(p=d[0],w=1),f||0===f||(f=p?this.N:this.resolution),this.db){if(this.db.search&&!1!==(i=this.db.search(this,d,e,g,h,o,u,l)))return i;const t=this;return async function(){for(let e,i;w<n;w++){if((i=d[w])&&!m[i]){if(m[i]=1,e=await At(t,i,p,0,0,!1,!1),e=jt(e,a,h,f)){a=e;break}p&&(h&&e&&a.length||(p=i))}h&&p&&w===n-1&&!a.length&&(f=t.resolution,p="",w=-1,m=s())}return vt(a,f,e,g,h,c,o)}()}for(let y,b;w<n;w++){if((b=d[w])&&!m[b]){if(m[b]=1,y=At(this,b,p,0,0,!1,!1),y=jt(y,a,h,f)){a=y;break}p&&(h&&y&&a.length||(p=b))}h&&p&&w===n-1&&!a.length&&(f=this.resolution,p="",w=-1,m=s())}return vt(a,f,e,g,h,c,o)},(e=Bt.prototype).mount=function(t){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),t.mount(this)},e.commit=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this)},e.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()},e.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db?(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[],this.db.clear()):this},e.append=function(t,e){return this.add(t,e,!0)},e.contain=function(t){return this.db?this.db.has(t):this.reg.has(t)},e.update=function(t,e){const i=this,n=this.remove(t);return n&&n.then?n.then((()=>i.add(t,e))):this.add(t,e)},e.cleanup=function(){return this.fastupdate?(wt(this.map),this.depth&&wt(this.ctx),this):this},e.searchCache=p,e.export=function(t,e,i=0,n=0){let s,r;switch(n){case 0:s="reg",r=gt(this.reg);break;case 1:s="cfg",r=null;break;case 2:s="map",r=ct(this.map,this.reg.size);break;case 3:s="ctx",r=ut(this.ctx,this.reg.size);break;default:return}return pt.call(this,t,e,s,r,i,n)},e.import=function(t,e){if(e)switch("string"==typeof e&&(e=JSON.parse(e)),t=t.split("."),"json"===t[t.length-1]&&t.pop(),3===t.length&&t.shift(),t=t.length>1?t[1]:t[0],t){case"reg":this.fastupdate=!1,this.reg=dt(e,this.reg);break;case"map":this.map=ft(e,this.map);break;case"ctx":this.ctx=at(e,this.ctx)}},e.serialize=function(t=!0){let e="",i="",n="";if(this.reg.size){let t;for(var s of this.reg.keys())t||(t=typeof s),e+=(e?",":"")+("string"===t?'"'+s+'"':s);e="index.reg=new Set(["+e+"]);",i=mt(this.map,t),i="index.map=new Map(["+i+"]);";for(const e of this.ctx.entries()){s=e[0];let i=mt(e[1],t);i="new Map(["+i+"])",i='["'+s+'",'+i+"]",n+=(n?",":"")+i}n="index.ctx=new Map(["+n+"]);"}return t?"function inject(index){"+e+i+n+"}":e+i+n},P(Bt.prototype);const zt="undefined"!=typeof window&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),Dt=["map","ctx","tag","reg","cfg"],St=s();function Ct(t,e,i){const n=t.value;let s,r=0;for(let h,o=0;o<n.length;o++){if(h=i?n:n[o]){for(let t,i,r=0;r<e.length;r++)if(i=e[r],t=h.indexOf(i),t>=0){if(s=1,!(h.length>1)){n[o]=[];break}h.splice(t,1)}r+=h.length}if(i)break}r?s&&t.update(n):t.delete(),t.continue()}function _t(t,e){return new Promise(((i,n)=>{t.onsuccess=t.oncomplete=function(){e&&e(this.result),e=null,i(this.result)},t.onerror=t.onblocked=n,t=null}))}(e=function t(e,i={}){if(!this||this.constructor!==t)return new t(e,i);"object"==typeof e&&(i=e,e=e.name),this.id="flexsearch"+(e?":"+e.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=i.field?i.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=i.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}.prototype).mount=function(t){return t.index?t.mount(this):(t.db=this,this.open())},e.open=function(){if(this.db)return this.db;let t=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist(),St[t.id]||(St[t.id]=[]),St[t.id].push(t.field);const e=zt.open(t.id,1);return e.onupgradeneeded=function(){const e=t.db=this.result;for(let i,n=0;n<Dt.length;n++){i=Dt[n];for(let n,s=0;s<St[t.id].length;s++)n=St[t.id][s],e.objectStoreNames.contains(i+("reg"!==i&&n?":"+n:""))||e.createObjectStore(i+("reg"!==i&&n?":"+n:""))}},t.db=_t(e,(function(e){t.db=e,t.db.onversionchange=function(){t.close()}}))},e.close=function(){this.db&&this.db.close(),this.db=null},e.destroy=function(){return _t(zt.deleteDatabase(this.id))},e.clear=function(){const t=[];for(let i,n=0;n<Dt.length;n++){i=Dt[n];for(let e,n=0;n<St[this.id].length;n++)e=St[this.id][n],t.push(i+("reg"!==i&&e?":"+e:""))}const e=this.db.transaction(t,"readwrite");for(let i=0;i<t.length;i++)e.objectStore(t[i]).clear();return _t(e)},e.get=function(t,e,i=0,n=0,s=!0,r=!1){t=this.db.transaction((e?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((e?"ctx":"map")+(this.field?":"+this.field:"")).get(e?e+":"+t:t);const h=this;return _t(t).then((function(t){let e=[];if(!t||!t.length)return e;if(s){if(!i&&!n&&1===t.length)return t[0];for(let s,r=0;r<t.length;r++)if((s=t[r])&&s.length){if(n>=s.length){n-=s.length;continue}const t=i?n+Math.min(s.length-n,i):s.length;for(let i=n;i<t;i++)e.push(s[i]);if(n=0,e.length===i)break}return r?h.enrich(e):e}return t}))},e.tag=function(t,e=0,i=0,n=!1){t=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(t);const s=this;return _t(t).then((function(t){return!t||!t.length||i>=t.length?[]:e||i?(t=t.slice(i,i+e),n?s.enrich(t):t):t}))},e.enrich=function(t){"object"!=typeof t&&(t=[t]);const e=this.db.transaction("reg","readonly").objectStore("reg"),i=[];for(let n=0;n<t.length;n++)i[n]=_t(e.get(t[n]));return Promise.all(i).then((function(e){for(let i=0;i<e.length;i++)e[i]={id:t[i],doc:e[i]?JSON.parse(e[i]):null};return e}))},e.has=function(t){return _t(t=this.db.transaction("reg","readonly").objectStore("reg").getKey(t)).then((function(t){return!!t}))},e.search=null,e.info=function(){},e.transaction=function(t,e,i){t+="reg"!==t&&this.field?":"+this.field:"";let n=this.h[t+":"+e];if(n)return i.call(this,n);let s=this.db.transaction(t,e);this.h[t+":"+e]=n=s.objectStore(t);const r=i.call(this,n);return this.h[t+":"+e]=null,_t(s).finally((function(){return r}))},e.commit=async function(t){let e=t.commit_task,i=[];t.commit_task=[];for(let n,s=0;s<e.length;s++)n=e[s],n.del&&i.push(n.del);i.length&&await this.remove(i),t.reg.size&&(await this.transaction("map","readwrite",(function(e){for(const i of t.map){const t=i[0],n=i[1];n.length&&(e.get(t).onsuccess=function(){let i=this.result;var s;if(i&&i.length){const t=Math.max(i.length,n.length);for(let e,r,h=0;h<t;h++)if((r=n[h])&&r.length){if((e=i[h])&&e.length)for(s=0;s<r.length;s++)e.push(r[s]);else i[h]=r;s=1}}else i=n,s=1;s&&e.put(i,t)})}})),await this.transaction("ctx","readwrite",(function(e){for(const i of t.ctx){const t=i[0],n=i[1];for(const i of n){const n=i[0],s=i[1];s.length&&(e.get(t+":"+n).onsuccess=function(){let i=this.result;var r;if(i&&i.length){const t=Math.max(i.length,s.length);for(let e,n,h=0;h<t;h++)if((n=s[h])&&n.length){if((e=i[h])&&e.length)for(r=0;r<n.length;r++)e.push(n[r]);else i[h]=n;r=1}}else i=s,r=1;r&&e.put(i,t+":"+n)})}}})),t.store?await this.transaction("reg","readwrite",(function(e){for(const i of t.store){const t=i[0],n=i[1];e.put("object"==typeof n?JSON.stringify(n):1,t)}})):t.bypass||await this.transaction("reg","readwrite",(function(e){for(const i of t.reg.keys())e.put(1,i)})),t.tag&&await this.transaction("tag","readwrite",(function(e){for(const i of t.tag){const t=i[0],n=i[1];n.length&&(e.get(t).onsuccess=function(){let i=this.result;i=i&&i.length?i.concat(n):n,e.put(i,t)})}})),t.map.clear(),t.ctx.clear(),t.tag&&t.tag.clear(),t.store&&t.store.clear(),t.document||t.reg.clear())},e.remove=function(t){return"object"!=typeof t&&(t=[t]),Promise.all([this.transaction("map","readwrite",(function(e){e.openCursor().onsuccess=function(){const e=this.result;e&&Ct(e,t)}})),this.transaction("ctx","readwrite",(function(e){e.openCursor().onsuccess=function(){const e=this.result;e&&Ct(e,t)}})),this.transaction("tag","readwrite",(function(e){e.openCursor().onsuccess=function(){const e=this.result;e&&Ct(e,t,!0)}})),this.transaction("reg","readwrite",(function(e){for(let i=0;i<t.length;i++)e.delete(t[i])}))])};const It=ht;let Ot,Lt;const Et=new WeakMap,Pt=new WeakMap,qt=new WeakMap,Nt=new WeakMap,Ft=new WeakMap;let Tt={get(t,e,i){if(t instanceof IDBTransaction){if("done"===e)return Pt.get(t);if("objectStoreNames"===e)return t.objectStoreNames||qt.get(t);if("store"===e)return i.objectStoreNames[1]?void 0:i.objectStore(i.objectStoreNames[0])}return Rt(t[e])},set:(t,e,i)=>(t[e]=i,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function $t(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Lt||(Lt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Jt(this),t),Rt(Et.get(this))}:function(...t){return Rt(e.apply(Jt(this),t))}:function(t,...i){const n=e.call(Jt(this),t,...i);return qt.set(n,t.sort?t.sort():[t]),Rt(n)}:(t instanceof IDBTransaction&&function(t){if(Pt.has(t))return;const e=new Promise(((e,i)=>{const n=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),n()},r=()=>{i(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));Pt.set(t,e)}(t),i=t,(Ot||(Ot=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>i instanceof t))?new Proxy(t,Tt):t);var e,i}function Rt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,i)=>{const n=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(Rt(t.result)),n()},r=()=>{i(t.error),n()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&Et.set(e,t)})).catch((()=>{})),Ft.set(e,t),e}(t);if(Nt.has(t))return Nt.get(t);const e=$t(t);return e!==t&&(Nt.set(t,e),Ft.set(e,t)),e}const Jt=t=>Ft.get(t);function Kt(t,e,{blocked:i,upgrade:n,blocking:s,terminated:r}={}){const h=indexedDB.open(t,e),o=Rt(h);return n&&h.addEventListener("upgradeneeded",(t=>{n(Rt(h.result),t.oldVersion,t.newVersion,Rt(h.transaction),t)})),i&&h.addEventListener("blocked",(t=>i(t.oldVersion,t.newVersion,t))),o.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(t=>s(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),o}const Wt=["get","getKey","getAll","getAllKeys","count"],Vt=["put","add","delete","clear"],Gt=new Map;function Ht(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Gt.get(e))return Gt.get(e);const i=e.replace(/FromIndex$/,""),n=e!==i,s=Vt.includes(i);if(!(i in(n?IDBIndex:IDBObjectStore).prototype)||!s&&!Wt.includes(i))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let h=r.store;return n&&(h=h.index(e.shift())),(await Promise.all([h[i](...e),s&&r.done]))[0]};return Gt.set(e,r),r}function Ut(t,e){var i={};for(var n in t)({}).hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&{}.propertyIsEnumerable.call(t,n[s])&&(i[n[s]]=t[n[s]])}return i}var Zt;Zt=Tt,Tt={...Zt,get:(t,e,i)=>Ht(t,e)||Zt.get(t,e,i),has:(t,e)=>!!Ht(t,e)||Zt.has(t,e)},"function"==typeof SuppressedError&&SuppressedError;export{It as D,Ut as _,Kt as o};
